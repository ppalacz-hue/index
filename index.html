<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>AUTODOC PRO ‚Äì System Firmowy 3.1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- FullCalendar -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>

<style>
body{margin:0;font-family:Arial,sans-serif;background:#ff5a00;display:flex;flex-direction:column;align-items:center;min-height:100vh;}
body::before{content:"";position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:75vw;height:75vh;background:url('mapa.png') no-repeat center;background-size:contain;opacity:0.12;z-index:0;pointer-events:none;}
.top-logo{margin-top:80px;margin-bottom:30px;z-index:2;}
.top-logo img{height:30px;}
.panel{background:white;width:900px;max-width:95%;min-height:220px;display:flex;align-items:center;justify-content:space-between;border-radius:8px;box-shadow:0 10px 25px rgba(0,0,0,0.3);z-index:2;}
.left-icon,.right-icon{width:180px;height:100%;background:#f4b38f;display:flex;align-items:center;justify-content:center;font-size:60px;color:white;}
.center-input{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;}
input,select{width:400px;max-width:90%;padding:15px;font-size:18px;margin-top:10px;border:2px solid #ff5a00;border-radius:6px;}
button{margin-top:15px;padding:12px 30px;font-size:18px;border:none;background:#ff5a00;color:white;border-radius:6px;cursor:pointer;}
button:hover{background:#e04e00;}
.reset-btn{background:#0f1f26;margin-left:15px;}
.reset-btn:hover{background:#162f3a;}
.results{margin-top:40px;background:white;padding:30px;border-radius:8px;width:900px;max-width:95%;display:none;box-shadow:0 8px 20px rgba(0,0,0,0.3);z-index:2;}
.result-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:20px;font-size:18px;}
.note{margin-top:25px;font-size:14px;color:#555;}
.logo-bar{margin-top:auto;width:100%;background:white;padding:15px 0;display:flex;justify-content:center;align-items:center;gap:30px;box-shadow:0 -3px 10px rgba(0,0,0,0.2);z-index:5;}
.logo-bar img{height:30px;}
.bottom-icons{display:flex;gap:15px;}
.icon-btn{width:42px;height:42px;background:#f4f4f4;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:22px;cursor:pointer;transition:0.2s;}
.icon-btn:hover{background:#ff5a00;transform:scale(1.1);}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);justify-content:center;align-items:center;z-index:20;}
.modal-content{background:white;padding:30px;border-radius:10px;width:90%;max-width:900px;text-align:center;max-height:90vh;overflow:auto;}
#calendar{margin-top:20px;}
.leave-table{width:100%;border-collapse:collapse;margin-top:15px;}
.leave-table th, .leave-table td{border:1px solid #ccc;padding:8px;text-align:center;}
.leave-table th{background:#f4f4f4;}
.status-yes{color:green;font-weight:bold;}
.status-no{color:red;font-weight:bold;}
</style>
</head>
<body>

<div class="top-logo"><img src="logo.svg"></div>

<div class="panel">
<div class="left-icon">‚ù§</div>
<div class="center-input">
<input type="text" id="employeeId" placeholder="ZESKANUJ / WPISZ ID">
<div>
<button onclick="checkBonus()">SPRAWD≈π BONUS</button>
<button class="reset-btn" onclick="resetPanel()">ZERUJ</button>
</div>
</div>
<div class="right-icon">‚ö°</div>
</div>

<div class="results" id="resultsBox">
<h2>Twoje wyniki:</h2>
<div class="result-grid">
<div><strong>Bonus:</strong> <span id="bonus"></span></div>
<div><strong>UPH:</strong> <span id="uph"></span></div>
<div><strong>Czas pracy:</strong> <span id="worked"></span></div>
<div><strong>Limit:</strong> <span id="limit"></span></div>
<div><strong>Status:</strong> <span id="status"></span></div>
<div><strong>Data:</strong> <span id="date"></span></div>
</div>

<div style="margin-top:15px;">
<label>Popro≈õ o korektƒô do lidera:</label>
<select id="correctionSelect">
<option value="">Wybierz lidera</option>
<option>Gosia</option>
<option>Agnieszka</option>
<option>Paulina</option>
<option>Mariia</option>
<option>Adrian</option>
<option>Yevheniia</option>
</select>
<button onclick="requestCorrection()">Wy≈õlij</button>
</div>

<button onclick="openSchedule()">üìÖ Tw√≥j grafik</button>
<button onclick="openLeave()">üìù Wniosek urlopowy</button>
<button onclick="openLeaderPanel()">üîë Panel lidera (testowo)</button>

</div>

<div class="logo-bar">
<img src="autodoc-logo.png">
<div class="bottom-icons">
<div class="icon-btn" onclick="openHR()">üë•</div>
<div class="icon-btn" onclick="openQR()">üí¨</div>
<div class="icon-btn" onclick="goToSite()">üåç</div>
</div>
</div>

<!-- HR -->
<div id="hrModal" class="modal">
<div class="modal-content">
<h3>Dzia≈Ç HR ‚Äì Budynek M40</h3>
<p>Poniedzia≈Çek ‚Äì PiƒÖtek</p>
<p>08:00 ‚Äì 16:00</p>
<button onclick="closeHR()">ZAMKNIJ</button>
</div>
</div>

<!-- QR -->
<div id="qrModal" class="modal">
<div class="modal-content">
<h3>Prze≈Ço≈ºeni</h3>
<p><strong>Inbound:</strong> Gosia, Agnieszka</p>
<p><strong>Outbound:</strong> Paulina, Mariia</p>
<p><strong>Antresola:</strong> Adrian, Yevheniia</p>
<img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=https://autodoc.pl">
<button onclick="closeQR()">ZAMKNIJ</button>
</div>
</div>

<!-- Grafik -->
<div id="scheduleModal" class="modal">
<div class="modal-content">
<h3>Grafik miesiƒôczny</h3>
<div id="calendar"></div>
<button onclick="closeSchedule()">ZAMKNIJ</button>
</div>
</div>

<!-- Urlop -->
<div id="leaveModal" class="modal">
<div class="modal-content">
<h3>Wniosek o urlop</h3>
<input type="text" id="leaveName" placeholder="Imiƒô i nazwisko">
<select id="leaveDept">
<option value="">Wybierz dzia≈Ç</option>
<option>Inbound</option>
<option>Outbound</option>
<option>Antresola</option>
</select>
<input type="text" id="leaveBoss" placeholder="Prze≈Ço≈ºony">
<select id="leaveType">
<option value="">Wybierz typ urlopu</option>
<option>Opieka</option>
<option>Urodzinowy</option>
<option>Na ≈ºƒÖdanie</option>
</select>
<select id="leaveWarehouse">
<option value="">Wybierz magazyn</option>
<option>M10</option>
<option>M13</option>
<option>M40</option>
</select>
<button onclick="submitLeave()">WY≈öLIJ</button>
<button onclick="closeLeave()">ZAMKNIJ</button>
</div>
</div>

<!-- Panel Lidera -->
<div id="leaderPanel" class="modal">
<div class="modal-content">
<h3>Panel Lidera ‚Äì Wnioski urlopowe</h3>
<label>Filtr magazyn:</label>
<select id="warehouseFilter" onchange="filterWarehouse()">
<option value="">Wszystkie</option>
<option>M10</option>
<option>M13</option>
<option>M40</option>
</select>

<table class="leave-table" id="leaveRequestsTable">
<tr><th>Imiƒô i nazwisko</th><th>Dzia≈Ç</th><th>Prze≈Ço≈ºony</th><th>Typ</th><th>Magazyn</th><th>Status</th></tr>
</table>
<button onclick="closeLeaderPanel()">ZAMKNIJ</button>
</div>
</div>

<script>
let employees={
"8500":{bonus:"5200 z≈Ç",uph:"132",limit:160,date:"01.02.2026",shiftType:"A",name:"Jan Kowalski"},
"9999":{bonus:"0",uph:"0",limit:0,date:"-",shiftType:"LEADER",name:"Lider Testowy"}
};
let loggedUser=null;
let calendar=null;
let leaveRequests=[];

function checkBonus(){
const id=employeeId.value.trim();
const data=employees[id];
if(!data) return alert("Nie znaleziono pracownika!");
loggedUser=data;

bonus.innerText=data.bonus;
uph.innerText=data.uph;
limit.innerText=data.limit+" h";
date.innerText=data.date;

resultsBox.style.display="block";
updateStatus();

employeeId.value="";

if(data.shiftType==="LEADER"){
openLeaderPanel();
}
}

function updateStatus(){
let total=0;
if(calendar){
calendar.getEvents().forEach(e=>{total+=e.extendedProps.hours||0;});
}
worked.innerText=total+" h";
if(total>=loggedUser.limit){status.innerText="Limit wyrobiony ‚úÖ";status.style.color="green";}
else{status.innerText="Brakuje "+(loggedUser.limit-total)+" h";status.style.color="red";}
}

function resetPanel(){resultsBox.style.display="none";loggedUser=null;}
function openHR(){hrModal.style.display="flex";}
function closeHR(){hrModal.style.display="none";}
function openQR(){qrModal.style.display="flex";}
function closeQR(){qrModal.style.display="none";}
function goToSite(){window.open("https://autodoc.pl","_blank");}

function openSchedule(){
if(!loggedUser) return alert("Najpierw sprawd≈∫ ID!");
scheduleModal.style.display="flex";
if(!calendar) initCalendar();
}
function closeSchedule(){scheduleModal.style.display="none";}

function initCalendar(){
calendar=new FullCalendar.Calendar(document.getElementById("calendar"),{
initialView:'dayGridMonth',
locale:'pl',
height:600,
events:generateSchedule(),
dateClick:function(info){
let add=confirm("Dodaj urlop w tym dniu?");
if(add) addLeaveByDay(info.date);
}
});
calendar.render();
updateStatus();
}

function generateSchedule(){
const events=[];
const now=new Date();
const y=now.getFullYear();
const m=now.getMonth();
for(let i=1;i<=30;i++){
let shift;
if(loggedUser.shiftType==="A"){
if(i%4===0) shift={title:"Wolne",hours:0,color:"#999"};
else if(i%3===0) shift={title:"14:00-22:00",hours:8,color:"#2196F3"};
else shift={title:"06:00-14:00",hours:8,color:"#4CAF50"};
}
if(loggedUser.shiftType==="LEADER") shift={title:"LEADER DAY",hours:0,color:"#000"};
events.push({title:shift.title,start:new Date(y,m,i),color:shift.color,extendedProps:{hours:shift.hours}});
}
return events;
}

function openLeave(){
if(!loggedUser) return alert("Najpierw sprawd≈∫ ID!");
leaveModal.style.display="flex";
if(loggedUser.name) leaveName.value=loggedUser.name;
}

function closeLeave(){leaveModal.style.display="none";}

function submitLeave(){
const name=leaveName.value;
const dept=leaveDept.value;
const boss=leaveBoss.value;
const type=leaveType.value;
const warehouse=leaveWarehouse.value||"M40";
if(!name||!dept||!boss||!type) return alert("Uzupe≈Çnij wszystkie pola!");

let day=prompt("Podaj dzie≈Ñ miesiƒÖca");
if(!day) return;

calendar.addEvent({title:"URLOP-"+type,start:new Date(new Date().getFullYear(),new Date().getMonth(),day),color:"#e53935",extendedProps:{hours:0}});
leaveRequests.push({name,dept,boss,type,warehouse,status:"Oczekuje"});
updateStatus();
closeLeave();
}

function addLeaveByDay(date){
let name=prompt("Imiƒô i nazwisko");
let dept=prompt("Dzia≈Ç (Inbound/Outbound/Antresola)");
let boss=prompt("Prze≈Ço≈ºony");
let type=prompt("Typ urlopu (Opieka/Urodzinowy/Na ≈ºƒÖdanie)");
let warehouse=prompt("Magazyn (M10/M13/M40)","M40");
if(!name||!dept||!boss||!type||!warehouse) return;
calendar.addEvent({title:"URLOP-"+type,start:date,color:"#e53935",extendedProps:{hours:0}});
leaveRequests.push({name,dept,boss,type,warehouse,status:"Oczekuje"});
updateStatus();
alert("Urlop dodany do grafiku");
}

function requestCorrection(){let leader=correctionSelect.value;if(!leader)return alert("Wybierz lidera");alert("Wys≈Çano pro≈õbƒô do "+leader);}

function openLeaderPanel(){leaderPanel.style.display="flex";renderLeaderTable();}
function closeLeaderPanel(){leaderPanel.style.display="none";}

function renderLeaderTable(){
let table=leaveRequestsTable;
table.innerHTML='<tr><th>Imiƒô i nazwisko</th><th>Dzia≈Ç</th><th>Prze≈Ço≈ºony</th><th>Typ</th><th>Magazyn</th><th>Status</th></tr>';
leaveRequests.forEach((r,i)=>{
let row=table.insertRow();
row.insertCell(0).innerText=r.name;
row.insertCell(1).innerText=r.dept;
row.insertCell(2).innerText=r.boss;
row.insertCell(3).innerText=r.type;
row.insertCell(4).innerText=r.warehouse;
let st=row.insertCell(5);
st.innerHTML=`<span class="${r.status==="Zatwierdzony"?"status-yes":"status-no"}">${r.status==="Zatwierdzony"?"‚úÖ":"‚ùå"}</span>
<button onclick="approveLeave(${i})">‚úî</button><button onclick="rejectLeave(${i})">‚úñ</button>`;
});
}

function approveLeave(i){leaveRequests[i].status="Zatwierdzony";renderLeaderTable();}
function rejectLeave(i){leaveRequests[i].status="Odrzucony";renderLeaderTable();}
function filterWarehouse(){
let w=warehouseFilter.value;
leaveRequestsTable.querySelectorAll("tr:not(:first-child)").forEach((r,index)=>{
r.style.display=(w===""||leaveRequests[index].warehouse===w)?"":"none";
});
}

</script>
</body>
</html>